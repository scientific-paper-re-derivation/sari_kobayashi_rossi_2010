(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     44565,       1461]
NotebookOptionsPosition[     41163,       1350]
NotebookOutlinePosition[     41510,       1365]
CellTagsIndexPosition[     41467,       1362]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"eqn\[LetterSpace]1", "=", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{"r1", ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "2"}], "}"}]}], "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"G", " ", "M"}], 
        SuperscriptBox[
         RowBox[{"Norm", "[", "r1", "]"}], "3"]]}], "r1"}], "+", 
     RowBox[{
      FractionBox[
       RowBox[{"G", " ", "m2"}], 
       SuperscriptBox[
        RowBox[{"Norm", "[", 
         RowBox[{"r2", "-", "r1"}], "]"}], "3"]], 
      RowBox[{"(", 
       RowBox[{"r2", "-", "r1"}], ")"}]}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.678838716587288*^9, 3.6788387612016983`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqn\[LetterSpace]2", "=", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{"r2", ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "2"}], "}"}]}], "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"G", " ", "M"}], 
        SuperscriptBox[
         RowBox[{"Norm", "[", "r2", "]"}], "3"]]}], "r2"}], "+", 
     RowBox[{
      FractionBox[
       RowBox[{"G", " ", "m1"}], 
       SuperscriptBox[
        RowBox[{"Norm", "[", 
         RowBox[{"r2", "-", "r1"}], "]"}], "3"]], 
      RowBox[{"(", 
       RowBox[{"r2", "-", "r1"}], ")"}]}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.67883876276167*^9, 3.678838807852993*^9}, {
  3.6788389797238054`*^9, 3.6788389798062115`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqn\[LetterSpace]3", "=", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{"rtil", ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "2"}], "}"}]}], "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"G", " ", "M"}], 
        SuperscriptBox[
         RowBox[{"Norm", "[", "r2", "]"}], "3"]]}], "r2"}], "+", 
     RowBox[{
      FractionBox[
       RowBox[{"G", " ", "M"}], 
       SuperscriptBox[
        RowBox[{"Norm", "[", "r1", "]"}], "3"]], "r1"}], "-", 
     RowBox[{
      FractionBox[
       RowBox[{"G", " ", "m"}], 
       SuperscriptBox[
        RowBox[{"Norm", "[", "rtil", "]"}], "3"]], "rtil"}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6788389269246473`*^9, 3.6788389908359222`*^9}, {
  3.6788390227389946`*^9, 3.6788390304394197`*^9}}],

Cell["Validate equation 3", "Text",
 CellChangeTimes->{{3.6788392725016174`*^9, 3.678839281133729*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"eqn\[LetterSpace]3", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", " ", 
   RowBox[{"rtil", "\[Rule]", 
    RowBox[{"r2", "-", "r1"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", " ", "/.", " ", 
   RowBox[{"m", "\[Rule]", " ", 
    RowBox[{"m2", "-", "m1"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", " ", "/.", " ", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"eqn\[LetterSpace]1", ",", 
      RowBox[{"Dt", "[", 
       RowBox[{"r1", ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", " ", "/.", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"eqn\[LetterSpace]2", ",", 
      RowBox[{"Dt", "[", 
       RowBox[{"r2", ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", "%", "]"}]}], "Input",
 CellChangeTimes->{{3.6788390320325923`*^9, 3.6788390854433527`*^9}, {
  3.6788391191199245`*^9, 3.678839132510339*^9}, {3.6788392260209703`*^9, 
  3.6788392376772914`*^9}, {3.678839268962254*^9, 3.678839269455635*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.678839076294902*^9, 3.678839086001326*^9}, {
   3.6788391209491262`*^9, 3.6788391344608526`*^9}, {3.6788392208480206`*^9, 
   3.678839237933217*^9}, 3.6788392697846527`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqn\[LetterSpace]4", "=", 
   RowBox[{"rm", "\[Equal]", 
    FractionBox[
     RowBox[{"2", "rp"}], 
     RowBox[{"1", "+", 
      RowBox[{"Cos", "[", "f", "]"}]}]]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.678839547539559*^9, 3.6788395615007396`*^9}}],

Cell["\<\
To calculate the velocity at periapse, we use the fact that the total energy \
is zero, and the radial velocity is zero\
\>", "Text",
 CellChangeTimes->{{3.6788396719683495`*^9, 3.6788397396571865`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"G", " ", "M"}], "r"]}], "+", 
    RowBox[{
     FractionBox["1", "2"], 
     SuperscriptBox["v", "2"]}]}], "\[Equal]", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", " ", "/.", " ", 
   RowBox[{"r", "\[Rule]", "rp"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v", "/.", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"%", ",", "v"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v\[LetterSpace]peri", "=", "%"}], ";"}]}], "Input",
 CellChangeTimes->{{3.678839719665187*^9, 3.6788398225427437`*^9}}],

Cell["The angular momentum is therefore", "Text",
 CellChangeTimes->{{3.6788398361140227`*^9, 3.678839842153536*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"angular\[LetterSpace]momentum", "=", 
   RowBox[{"v\[LetterSpace]peri", "*", "rp"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6788398443947954`*^9, 3.6788398601614375`*^9}}],

Cell["Angular acceleration", "Text",
 CellChangeTimes->{{3.6788398764440727`*^9, 3.6788398848354077`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"l", "/", 
   SuperscriptBox["rm", "2"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", " ", "/.", " ", 
   RowBox[{"l", "\[Rule]", " ", "angular\[LetterSpace]momentum"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", " ", "/.", " ", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"eqn\[LetterSpace]4", ",", "rm"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fdot", "=", "%"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6788399018886547`*^9, 3.6788399220000896`*^9}, {
  3.6788400018353615`*^9, 3.678840004084355*^9}}],

Cell[BoxData[{
 RowBox[{
  FractionBox["1", "fdot"], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Integrate", "[", 
   RowBox[{"%", ",", "f"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"my\[LetterSpace]eqn\[LetterSpace]5", "=", 
   RowBox[{"ttil", "==", "%"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6788400439830847`*^9, 3.678840052427659*^9}, {
  3.6788401091587334`*^9, 3.6788401284615297`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqn\[LetterSpace]5", "=", 
   RowBox[{"ttil", "\[Equal]", 
    RowBox[{
     FractionBox[
      SqrtBox["2"], "3"], 
     SqrtBox[
      FractionBox[
       SuperscriptBox["rp", "3"], 
       RowBox[{"G", " ", "M"}]]], 
     RowBox[{"Tan", "[", 
      FractionBox["f", "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{"3", "+", 
       SuperscriptBox[
        RowBox[{"Tan", "[", 
         FractionBox["f", "2"], "]"}], "2"]}], ")"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6788401208315763`*^9, 3.678840160674735*^9}}],

Cell["Now I need to show that both forms are equivalent", "Text",
 CellChangeTimes->{{3.6788401651247015`*^9, 3.6788401800262127`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   FractionBox[
    RowBox[{"eqn\[LetterSpace]5", "[", 
     RowBox[{"[", "2", "]"}], "]"}], 
    RowBox[{"my\[LetterSpace]eqn\[LetterSpace]5", "[", 
     RowBox[{"[", "2", "]"}], "]"}]], "\[Equal]", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"%", ",", 
   RowBox[{
    RowBox[{"G", ">", "0"}], "&&", 
    RowBox[{"M", ">", "0"}], "&&", 
    RowBox[{"rp", ">", "0"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.678840182331732*^9, 3.6788402264710484`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.678840207254567*^9, 3.6788402269715643`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqn\[LetterSpace]6", "=", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{"rtil", ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "2"}], "}"}]}], "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"G", " ", "M"}], 
        SuperscriptBox["rm", "3"]]}], "rtil"}], "+", 
     RowBox[{"3", "*", 
      FractionBox[
       RowBox[{"G", " ", "M"}], 
       SuperscriptBox["rm", "5"]], 
      RowBox[{"Dot", "[", 
       RowBox[{"r", ",", "rm"}], "]"}], "rm"}], "-", 
     RowBox[{
      FractionBox[
       RowBox[{"G", " ", "M"}], 
       SuperscriptBox["rtil", "3"]], "rtil"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6788494654645605`*^9, 3.6788495134314575`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqn\[LetterSpace]7", "=", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{"r", ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "2"}], "}"}]}], "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["rp", "rm"], ")"}], "3"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "r"}], "+", 
        RowBox[{"3", "*", 
         RowBox[{"Dot", "[", 
          RowBox[{"r", ",", "rmhat"}], "]"}], "rmhat"}]}], ")"}]}], "-", 
     FractionBox["r", 
      SuperscriptBox[
       RowBox[{"Norm", "[", "r", "]"}], "3"]]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6788495532301984`*^9, 3.678849616969673*^9}}],

Cell["Validate equations in the paper", "Text",
 CellChangeTimes->{{3.6788498803361607`*^9, 3.678849889100549*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Dt", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "2"}], "}"}]}], "]"}], "\[Equal]", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["rp", "rm"], ")"}], "3"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "+", 
       RowBox[{"3", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z"}], "}"}], ".", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Cos", "[", "f", "]"}], ",", 
            RowBox[{"Sin", "[", "f", "]"}], ",", "0"}], "}"}]}], ")"}], 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", "f", "]"}], ",", 
          RowBox[{"Sin", "[", "f", "]"}], ",", "0"}], "}"}]}]}], ")"}]}], "-", 
    FractionBox[
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"], "+", 
        SuperscriptBox["z", "2"]}], ")"}], 
      RowBox[{"3", "/", "2"}]]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", " ", "/.", " ", 
   RowBox[{"rm", "\[Rule]", " ", 
    RowBox[{"2", " ", 
     RowBox[{"rp", "/", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"Cos", "[", "f", "]"}]}], ")"}]}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Thread", "[", "%", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"my\[LetterSpace]eqns\[LetterSpace]8910", "=", "%"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.678850376474885*^9, 3.678850514455694*^9}, {
  3.678850596602376*^9, 3.6788506197947655`*^9}}],

Cell["Validate equations 8 - 10", "Text",
 CellChangeTimes->{{3.6788505195246944`*^9, 3.6788505261065817`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqn\[LetterSpace]8", "=", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{"x", ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "2"}], "}"}]}], "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"Cos", "[", "f", "]"}]}], ")"}], "3"], "8"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "x"}], "+", 
        RowBox[{"3", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x", " ", 
            RowBox[{"Cos", "[", "f", "]"}]}], "+", 
           RowBox[{"y", " ", 
            RowBox[{"Sin", "[", "f", "]"}]}]}], ")"}], 
         RowBox[{"Cos", "[", "f", "]"}]}]}], ")"}]}], "-", 
     FractionBox["x", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.678850527315505*^9, 3.6788505673166437`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"eqn\[LetterSpace]8", "/.", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"my\[LetterSpace]eqns\[LetterSpace]8910", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"Dt", "[", 
       RowBox[{"x", ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", "%", "]"}]}], "Input",
 CellChangeTimes->{{3.678850574591349*^9, 3.6788505912054234`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.6788505877443004`*^9, 3.678850621870897*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqn\[LetterSpace]9", "=", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{"y", ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "2"}], "}"}]}], "]"}], "==", 
    RowBox[{
     RowBox[{
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"Cos", "[", "f", "]"}]}], ")"}], "3"], "8"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "y"}], "+", 
        RowBox[{"3", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x", " ", 
            RowBox[{"Cos", "[", "f", "]"}]}], "+", 
           RowBox[{"y", " ", 
            RowBox[{"Sin", "[", "f", "]"}]}]}], ")"}], 
         RowBox[{"Sin", "[", "f", "]"}]}]}], ")"}]}], "-", 
     FractionBox["y", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6788506242654967`*^9, 3.678850686496241*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"eqn\[LetterSpace]9", "/.", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"my\[LetterSpace]eqns\[LetterSpace]8910", "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", 
      RowBox[{"Dt", "[", 
       RowBox[{"y", ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", "%", "]"}]}], "Input",
 CellChangeTimes->{{3.6788506570470257`*^9, 3.6788506748781705`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.678850669282714*^9, 3.6788506891458673`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqn\[LetterSpace]10", "=", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{"z", ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "2"}], "}"}]}], "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"Cos", "[", "f", "]"}]}], ")"}], "3"], "8"]}], "z"}], "-", 
     FractionBox["z", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6788506918475904`*^9, 3.678850725245679*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqn\[LetterSpace]10", "/.", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"my\[LetterSpace]eqns\[LetterSpace]8910", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{"Dt", "[", 
      RowBox[{"z", ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6788507271311812`*^9, 3.6788507429253745`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.6788507433422236`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqn\[LetterSpace]11", "=", 
   RowBox[{"t", "==", 
    RowBox[{
     FractionBox[
      SqrtBox["2"], "3"], 
     RowBox[{"Tan", "[", 
      FractionBox["f", "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{"3", "+", 
       SuperscriptBox[
        RowBox[{"Tan", "[", 
         FractionBox["f", "2"], "]"}], "2"]}], ")"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6788507550847607`*^9, 3.6788507864732227`*^9}}],

Cell[BoxData[{
 RowBox[{"eqn\[LetterSpace]11", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dt", "[", 
   RowBox[{"%", ",", "t"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Dt", "[", 
    RowBox[{"f", ",", "t"}], "]"}], "/.", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"%", ",", 
      RowBox[{"Dt", "[", 
       RowBox[{"f", ",", "t"}], "]"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", "%", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqn\[LetterSpace]12", "=", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{"f", ",", "t"}], "]"}], "\[Equal]", "%"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.678850783317151*^9, 3.6788508955185127`*^9}}],

Cell["Validation", "Text",
 CellChangeTimes->{{3.6788509217697706`*^9, 3.678850925062417*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"eqn\[LetterSpace]12", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "/", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       SqrtBox["2"], "4"], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"Cos", "[", "f", "]"}]}], ")"}], "2"]}], ")"}]}], "\[Equal]",
    "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", "%", "]"}]}], "Input",
 CellChangeTimes->{{3.6788508976110687`*^9, 3.6788509430318184`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.6788508994039354`*^9, 3.678850902170757*^9}, {
  3.678850935518242*^9, 3.678850943366535*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"eqn\[LetterSpace]10", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", " ", "/.", " ", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{"z", ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "2"}], "}"}]}], "]"}], "\[Rule]", " ", 
    RowBox[{
     RowBox[{"eqn\[LetterSpace]12", "[", 
      RowBox[{"[", "2", "]"}], "]"}], " ", 
     RowBox[{"Dt", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"eqn\[LetterSpace]12", "[", 
         RowBox[{"[", "2", "]"}], "]"}], 
        RowBox[{"Dt", "[", 
         RowBox[{"z", ",", "f"}], "]"}]}], ",", "f"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", " ", "/.", 
   RowBox[{"x", "\[Rule]", "0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", " ", "/.", " ", 
   RowBox[{"y", "\[Rule]", "0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"%", ",", 
   RowBox[{"z", "\[Element]", "Reals"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6788522431629086`*^9, 3.6788524136249933`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"z", "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"Abs", "[", "z", "]"}], "3"], " ", 
     SuperscriptBox[
      RowBox[{"Cos", "[", 
       FractionBox["f", "2"], "]"}], "6"], " ", 
     RowBox[{"(", 
      RowBox[{"z", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"Cos", "[", "f", "]"}]}], ")"}], " ", 
        RowBox[{"Dt", "[", 
         RowBox[{"z", ",", 
          RowBox[{"{", 
           RowBox[{"f", ",", "2"}], "}"}]}], "]"}]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"Dt", "[", 
         RowBox[{"z", ",", "f"}], "]"}], " ", 
        RowBox[{"Sin", "[", "f", "]"}]}]}], ")"}]}]}], 
   RowBox[{"Abs", "[", "z", "]"}]], "\[Equal]", "0"}]], "Output",
 CellChangeTimes->{
  3.6788522885696583`*^9, {3.6788523296966925`*^9, 3.6788524140305204`*^9}}]
}, Open  ]],

Cell["Variation in the argument of periapis", "Text",
 CellChangeTimes->{{3.678853104112964*^9, 3.6788531105737205`*^9}, {
  3.6788531562799106`*^9, 3.678853164638424*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   FractionBox["2", 
    RowBox[{"1", "+", 
     RowBox[{"Cos", "[", "f", "]"}]}]], 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", "f", "]"}], ",", 
     RowBox[{"Sin", "[", "f", "]"}], ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
        RowBox[{"-", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", "0"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Theta]", "]"}], ",", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", "0"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], ".", "%"}], "-", 
   "%"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Series", "[", 
    RowBox[{"%", ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", "0", ",", "1"}], "}"}]}], "]"}], "/", 
   "\[Theta]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Normal", "[", "%", "]"}]}], "Input",
 CellChangeTimes->{{3.678852927130018*^9, 3.6788530739182763`*^9}, {
  3.678853120634921*^9, 3.678853139024166*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"Sin", "[", "f", "]"}]}], 
     RowBox[{"1", "+", 
      RowBox[{"Cos", "[", "f", "]"}]}]]}], ",", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{"Cos", "[", "f", "]"}]}], 
    RowBox[{"1", "+", 
     RowBox[{"Cos", "[", "f", "]"}]}]], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.678853140228298*^9}]
}, Open  ]],

Cell["Variation in periapse time", "Text",
 CellChangeTimes->{{3.6788533992575684`*^9, 3.6788534044141626`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   FractionBox["2", 
    RowBox[{"1", "+", 
     RowBox[{"Cos", "[", "f", "]"}]}]], 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", "f", "]"}], ",", 
     RowBox[{"Sin", "[", "f", "]"}], ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"%", "/.", 
     RowBox[{"f", "\[Rule]", " ", 
      RowBox[{"f", "+", "\[Epsilon]"}]}]}], ")"}], "-", "%"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Series", "[", 
   RowBox[{"%", ",", 
    RowBox[{"{", 
     RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Normal", "[", "%", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"Cos", "[", "f", "]"}]}], ")"}], "2"], "*", 
   RowBox[{"%", "/", "\[Epsilon]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", "%", "]"}]}], "Input",
 CellChangeTimes->{{3.6788534122827697`*^9, 3.678853440148596*^9}, {
  3.678888954019004*^9, 3.6788889971454067`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "2"}], " ", 
    RowBox[{"Sin", "[", "f", "]"}]}], ",", 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"Cos", "[", "f", "]"}]}], ")"}]}], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.678853422350658*^9, 3.678853440381974*^9}, {
  3.678888972498517*^9, 3.67888899802118*^9}}]
}, Open  ]],

Cell["Variation in periapse distance", "Text",
 CellChangeTimes->{{3.678853318968327*^9, 3.6788533258093157`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Dt", "[", 
    RowBox[{"eqn\[LetterSpace]5", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Dt", "[", "G", "]"}], "\[RuleDelayed]", "0"}], ",", 
     RowBox[{
      RowBox[{"Dt", "[", "M", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"Dt", "[", "rp", "]"}], "\[Rule]", "\[Epsilon]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Dt", "[", "f", "]"}], "/.", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"%", "\[Equal]", "0"}], ",", 
      RowBox[{"Dt", "[", "f", "]"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalDelta]f\[LetterSpace]vpd", "=", "%"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6788901188974066`*^9, 3.6788902501034813`*^9}, {
  3.6788902806147957`*^9, 3.6788902970365133`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   FractionBox["2", 
    RowBox[{"1", "+", 
     RowBox[{"Cos", "[", "f", "]"}]}]], 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", "f", "]"}], ",", 
     RowBox[{"Sin", "[", "f", "]"}], ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "\[Epsilon]"}], ")"}], "*", "%"}], "/.", 
     RowBox[{"f", "\[Rule]", 
      RowBox[{"f", "+", "\[CapitalDelta]f\[LetterSpace]vpd"}]}]}], ")"}], "-",
    "%"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[PartialD]", "\[Epsilon]"], "%"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", " ", "/.", 
   RowBox[{"\[Epsilon]", "\[Rule]", "0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", " ", "/.", " ", 
   RowBox[{"rp", "\[Rule]", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", "%", "]"}]}], "Input",
 CellChangeTimes->{{3.6788900841377287`*^9, 3.678890113568918*^9}, {
  3.6788903000554333`*^9, 3.678890361557173*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"2", "-", 
    RowBox[{"Cos", "[", "f", "]"}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Sin", "[", "f", "]"}]}], "+", 
    RowBox[{"Tan", "[", 
     FractionBox["f", "2"], "]"}]}], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.6788900918045626`*^9, 3.678890108651894*^9}, {
  3.678890300902748*^9, 3.678890362010879*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Sin", "[", "f", "]"}]}], "+", 
     RowBox[{"Tan", "[", 
      FractionBox["f", "2"], "]"}]}], 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Cos", "[", "f", "]"}]}], 
     RowBox[{"Tan", "[", 
      RowBox[{"f", "/", "2"}], "]"}]}]], "\[Equal]", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", "%", "]"}]}], "Input",
 CellChangeTimes->{{3.678890379063241*^9, 3.6788903924712934`*^9}, {
  3.678890480468833*^9, 3.678890480677415*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.6788903926839128`*^9, 3.678890480964199*^9}]
}, Open  ]],

Cell["Variation in eccentricity", "Text",
 CellChangeTimes->{{3.678853193667392*^9, 3.67885319939489*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Integrate", "[", 
   RowBox[{
    FractionBox["1", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"e", " ", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], ")"}], "2"]], ",", 
    "\[Theta]"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dt", "[", "%", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   FractionBox[
    RowBox[{"Dt", "[", "\[Theta]", "]"}], 
    RowBox[{"Dt", "[", "e", "]"}]], "/.", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"%", "\[Equal]", "0"}], ",", 
      RowBox[{"Dt", "[", "\[Theta]", "]"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Simplify", "[", "%", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{"%", ",", 
    RowBox[{"e", "\[Rule]", "1"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", " ", "/.", 
   RowBox[{"\[Theta]", "\[Rule]", "f"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalDelta]f\[LetterSpace]ev", "=", "%"}], ";"}]}], "Input",
 CellChangeTimes->{{3.678890636430214*^9, 3.678890790469326*^9}, {
  3.678890833509224*^9, 3.678890867767028*^9}, {3.6788932591783857`*^9, 
  3.6788932624493523`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   FractionBox["2", 
    RowBox[{"1", "+", 
     RowBox[{"e", " ", 
      RowBox[{"Cos", "[", "f", "]"}]}]}]], 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", "f", "]"}], ",", 
     RowBox[{"Sin", "[", "f", "]"}], ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"%", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"e", "\[Rule]", " ", 
        RowBox[{"1", "+", "\[CapitalDelta]e"}]}], ",", 
       RowBox[{"f", "\[Rule]", 
        RowBox[{"f", "+", 
         RowBox[{
         "\[CapitalDelta]f\[LetterSpace]ev", " ", "\[CapitalDelta]e"}]}]}]}], 
      "}"}]}], ")"}], "-", 
   RowBox[{"(", 
    RowBox[{"%", "/.", 
     RowBox[{"e", "\[Rule]", "1"}]}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[PartialD]", "\[CapitalDelta]e"], "%"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", " ", "/.", " ", 
   RowBox[{"\[CapitalDelta]e", "\[Rule]", "0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", "%", "]"}]}], "Input",
 CellChangeTimes->{{3.6788908712935715`*^9, 3.6788910081930866`*^9}, {
  3.6788932974646378`*^9, 3.678893298773389*^9}, {3.6788934688499217`*^9, 
  3.678893469213031*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{"5", "+", 
      RowBox[{"5", " ", 
       RowBox[{"Cos", "[", "f", "]"}]}], "+", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "f"}], "]"}], "-", 
      RowBox[{"Cos", "[", 
       RowBox[{"3", " ", "f"}], "]"}]}], 
     RowBox[{"5", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"Cos", "[", "f", "]"}]}], ")"}], "2"]}]]}], ",", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"3", "+", 
       RowBox[{"Cos", "[", "f", "]"}], "+", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "f"}], "]"}]}], ")"}], " ", 
     RowBox[{"Sin", "[", "f", "]"}]}], 
    RowBox[{"5", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"Cos", "[", "f", "]"}]}], ")"}], "2"]}]], ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.678890938613807*^9, 3.6788910121329465`*^9}, 
   3.678893268926607*^9, 3.6788932994607735`*^9}]
}, Open  ]],

Cell["Rotation around apsidal line", "Text",
 CellChangeTimes->{{3.678853028963129*^9, 3.6788530438711786`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   FractionBox["2", 
    RowBox[{"1", "+", 
     RowBox[{"Cos", "[", "f", "]"}]}]], 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", "f", "]"}], ",", 
     RowBox[{"Sin", "[", "f", "]"}], ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
        RowBox[{"-", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], ",", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], "}"}], ".", "%"}], 
   "-", "%"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Series", "[", 
    RowBox[{"%", ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", "0", ",", "1"}], "}"}]}], "]"}], "/", 
   "\[Theta]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Normal", "[", "%", "]"}]}], "Input",
 CellChangeTimes->{{3.678852927130018*^9, 3.6788530739182763`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{"Sin", "[", "f", "]"}]}], 
    RowBox[{"1", "+", 
     RowBox[{"Cos", "[", "f", "]"}]}]]}], "}"}]], "Output",
 CellChangeTimes->{3.67885307504092*^9}]
}, Open  ]],

Cell["Rotation about the latus rectum", "Text",
 CellChangeTimes->{{3.678852914495151*^9, 3.6788529238936043`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   FractionBox["2", 
    RowBox[{"1", "+", 
     RowBox[{"Cos", "[", "f", "]"}]}]], 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", "f", "]"}], ",", 
     RowBox[{"Sin", "[", "f", "]"}], ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", "0", ",", 
        RowBox[{"-", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Theta]", "]"}], ",", "0", ",", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], "}"}], ".", "%"}], 
   "-", "%"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Series", "[", 
    RowBox[{"%", ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", "0", ",", "1"}], "}"}]}], "]"}], "/", 
   "\[Theta]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Normal", "[", "%", "]"}]}], "Input",
 CellChangeTimes->{{3.678852927130018*^9, 3.678853019945856*^9}, {
  3.6788530787098503`*^9, 3.6788530808709397`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{"Cos", "[", "f", "]"}]}], 
    RowBox[{"1", "+", 
     RowBox[{"Cos", "[", "f", "]"}]}]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6788529391933737`*^9, {3.678852977549654*^9, 3.67885302045319*^9}, 
   3.6788530813027506`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{"G", " ", "M", " ", "m1", " ", "m2"}], 
     RowBox[{"m", " ", "rp"}]]}], 
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox["m", "M"], ")"}], 
    RowBox[{"1", "/", "3"}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox[
       SuperscriptBox["rp", "2"], 
       SuperscriptBox["rm", "2"]], 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}], ".", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Cos", "[", "f", "]"}], ",", 
         RowBox[{"Sin", "[", "f", "]"}], ",", "0"}], "}"}]}]}], "+", 
     "\[IndentingNewLine]", 
     FractionBox[
      RowBox[{
       RowBox[{"Dt", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], ".", 
       RowBox[{"Dt", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{"2", "rp"}], 
             RowBox[{"1", "+", 
              RowBox[{"Cos", "[", "f", "]"}]}]], 
            RowBox[{"Cos", "[", "f", "]"}]}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"2", "rp"}], 
             RowBox[{"1", "+", 
              RowBox[{"Cos", "[", "f", "]"}]}]], 
            RowBox[{"Sin", "[", "f", "]"}]}], ",", "0"}], "}"}], ",", "t"}], 
        "]"}]}], "rp"]}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", " ", "/.", " ", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{"rp", ",", "_"}], "]"}], "\[RuleDelayed]", "0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", " ", "/.", " ", 
   RowBox[{"rm", "\[Rule]", " ", 
    FractionBox[
     RowBox[{"2", "rp"}], 
     RowBox[{"1", "+", 
      RowBox[{"Cos", "[", "f", "]"}]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", " ", "/.", " ", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{"f", ",", "t"}], "]"}], "\[Rule]", " ", 
    RowBox[{"eqn\[LetterSpace]12", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", "%", "]"}]}], "Input",
 CellChangeTimes->{{3.6788541087627373`*^9, 3.6788543694189053`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"4", " ", "G", " ", "m1", " ", "m2", " ", 
      SuperscriptBox[
       RowBox[{"Cos", "[", 
        FractionBox["f", "2"], "]"}], "5"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SqrtBox["2"], " ", 
         RowBox[{"Cos", "[", 
          FractionBox["f", "2"], "]"}], " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"y", ",", "t"}], "]"}]}], "-", 
        RowBox[{
         SqrtBox["2"], " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"x", ",", "t"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          FractionBox["f", "2"], "]"}]}], "+", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"Cos", "[", 
           FractionBox["f", "2"], "]"}], "3"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x", " ", 
            RowBox[{"Cos", "[", "f", "]"}]}], "+", 
           RowBox[{"y", " ", 
            RowBox[{"Sin", "[", "f", "]"}]}]}], ")"}]}]}], ")"}]}], ")"}], 
    "/", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["m", "M"], ")"}], 
       RowBox[{"2", "/", "3"}]], " ", "rp", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"Cos", "[", "f", "]"}]}], ")"}], "2"]}], ")"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{
  3.6788542382708673`*^9, {3.678854277395344*^9, 3.678854324005312*^9}, {
   3.678854355154966*^9, 3.678854370688634*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqn\[LetterSpace]24", "=", 
   RowBox[{"rm", "\[Equal]", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox[
       RowBox[{"9", " ", "G", " ", "M", " ", 
        SuperscriptBox["ttil", "2"]}], "2"], ")"}], 
     RowBox[{"1", "/", "3"}]]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.678864467986494*^9, 3.678864483397477*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqn\[LetterSpace]25", "=", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{"r", ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "2"}], "}"}]}], "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       FractionBox["2", 
        RowBox[{"9", 
         SuperscriptBox["t", "2"]}]], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "r"}], "+", 
        RowBox[{"3", 
         RowBox[{"Dot", "[", 
          RowBox[{"r", ",", "rmhat"}], "]"}], "rmhat"}]}], ")"}]}], "-", 
     FractionBox["r", 
      SuperscriptBox[
       RowBox[{"Norm", "[", "r", "]"}], "3"]]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.678864507149521*^9, 3.678864546372953*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   FractionBox["rs", 
    RowBox[{"1", "+", 
     RowBox[{"e", " ", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]], 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
     RowBox[{"Sin", "[", "\[Theta]", "]"}], ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[PartialD]", "\[Theta]"], "%"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", "%", "]"}]}], "Input",
 CellChangeTimes->{{3.678888632376402*^9, 3.678888653582005*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{"rs", " ", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"e", " ", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], ")"}], "2"]]}], ",", 
   FractionBox[
    RowBox[{"rs", " ", 
     RowBox[{"(", 
      RowBox[{"e", "+", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ")"}]}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"e", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], ")"}], "2"]], ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.678888648972207*^9, 3.6788886538479524`*^9}}]
}, Open  ]]
},
WindowSize->{759, 553},
WindowMargins->{{Automatic, -43}, {37, Automatic}},
FrontEndVersion->"10.3 for Microsoft Windows (64-bit) (December 10, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 719, 23, 49, "Input"],
Cell[1280, 45, 769, 24, 49, "Input"],
Cell[2052, 71, 847, 27, 49, "Input"],
Cell[2902, 100, 103, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[3030, 105, 1277, 33, 132, "Input"],
Cell[4310, 140, 227, 3, 31, "Output"]
}, Open  ]],
Cell[4552, 146, 289, 8, 48, "Input"],
Cell[4844, 156, 213, 4, 49, "Text"],
Cell[5060, 162, 692, 22, 108, "Input"],
Cell[5755, 186, 117, 1, 30, "Text"],
Cell[5875, 189, 208, 4, 31, "Input"],
Cell[6086, 195, 106, 1, 30, "Text"],
Cell[6195, 198, 643, 17, 94, "Input"],
Cell[6841, 217, 425, 10, 88, "Input"],
Cell[7269, 229, 558, 18, 68, "Input"],
Cell[7830, 249, 135, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[7990, 254, 528, 15, 70, "Input"],
Cell[8521, 271, 99, 1, 31, "Output"]
}, Open  ]],
Cell[8635, 275, 759, 24, 47, "Input"],
Cell[9397, 301, 703, 22, 47, "Input"],
Cell[10103, 325, 115, 1, 30, "Text"],
Cell[10221, 328, 1835, 57, 172, "Input"],
Cell[12059, 387, 111, 1, 30, "Text"],
Cell[12173, 390, 1082, 34, 91, "Input"],
Cell[CellGroupData[{
Cell[13280, 428, 548, 14, 52, "Input"],
Cell[13831, 444, 99, 1, 31, "Output"]
}, Open  ]],
Cell[13945, 448, 1076, 34, 91, "Input"],
Cell[CellGroupData[{
Cell[15046, 486, 550, 14, 52, "Input"],
Cell[15599, 502, 99, 1, 31, "Output"]
}, Open  ]],
Cell[15713, 506, 760, 24, 56, "Input"],
Cell[CellGroupData[{
Cell[16498, 534, 459, 12, 31, "Input"],
Cell[16960, 548, 75, 1, 31, "Output"]
}, Open  ]],
Cell[17050, 552, 449, 14, 53, "Input"],
Cell[17502, 568, 787, 22, 112, "Input"],
Cell[18292, 592, 94, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[18411, 597, 520, 16, 80, "Input"],
Cell[18934, 615, 148, 2, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19119, 622, 1028, 29, 112, "Input"],
Cell[20150, 653, 868, 26, 57, "Output"]
}, Open  ]],
Cell[21033, 682, 172, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[21230, 688, 1266, 39, 150, "Input"],
Cell[22499, 729, 425, 14, 48, "Output"]
}, Open  ]],
Cell[22939, 746, 112, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[23076, 751, 1111, 35, 150, "Input"],
Cell[24190, 788, 382, 11, 31, "Output"]
}, Open  ]],
Cell[24587, 802, 114, 1, 30, "Text"],
Cell[24704, 805, 950, 27, 72, "Input"],
Cell[CellGroupData[{
Cell[25679, 836, 1091, 33, 150, "Input"],
Cell[26773, 871, 389, 11, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27199, 887, 553, 17, 79, "Input"],
Cell[27755, 906, 97, 1, 31, "Output"]
}, Open  ]],
Cell[27867, 910, 106, 1, 30, "Text"],
Cell[27976, 913, 1308, 37, 189, "Input"],
Cell[CellGroupData[{
Cell[29309, 954, 1270, 39, 130, "Input"],
Cell[30582, 995, 1021, 32, 49, "Output"]
}, Open  ]],
Cell[31618, 1030, 112, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[31755, 1035, 1210, 37, 150, "Input"],
Cell[32968, 1074, 262, 8, 48, "Output"]
}, Open  ]],
Cell[33245, 1085, 115, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[33385, 1090, 1261, 38, 150, "Input"],
Cell[34649, 1130, 341, 10, 48, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35027, 1145, 2215, 69, 237, "Input"],
Cell[37245, 1216, 1502, 47, 83, "Output"]
}, Open  ]],
Cell[38762, 1266, 367, 10, 52, "Input"],
Cell[39132, 1278, 720, 23, 48, "Input"],
Cell[CellGroupData[{
Cell[39877, 1305, 555, 17, 88, "Input"],
Cell[40435, 1324, 712, 23, 82, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
